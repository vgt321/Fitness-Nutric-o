<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clientes - Fitness NutricÃ£o</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <!-- CABEÃ‡ALHO -->
    <header>
        <div class="container">
            <h1>ğŸ‘¥ GestÃ£o de Clientes</h1>
            <p>Cadastre e gerencie seus clientes</p>
        </div>
    </header>

    <!-- MENU DE NAVEGAÃ‡ÃƒO -->
    <nav>
        <div class="container">
            <a href="../index.html" class="btn-nav">ğŸ  InÃ­cio</a>
            <a href="clientes.html" class="btn-nav active">ğŸ‘¥ Clientes</a>
            <a href="avaliacoes.html" class="btn-nav">ğŸ“Š AvaliaÃ§Ãµes</a>
            <a href="planos.html" class="btn-nav">ğŸ“‹ Planos</a>
            <a href="consultas.html" class="btn-nav">ğŸ“… Consultas</a>
            <a href="financeiro.html" class="btn-nav">ğŸ’° Financeiro</a>
        </div>
    </nav>

    <!-- CONTEÃšDO PRINCIPAL -->
    <main class="container">
        <!-- FORMULÃRIO DE CADASTRO -->
        <div class="form-box">
            <h2>ğŸ“ Cadastrar Novo Cliente</h2>
            <form id="formCliente">
                <!-- Nome completo -->
                <div class="form-group">
                    <label for="nome">Nome Completo *</label>
                    <input type="text" id="nome" required placeholder="Ex: JoÃ£o Silva">
                </div>

                <!-- CPF -->
                <div class="form-group">
                    <label for="cpf">CPF *</label>
                    <input type="text" id="cpf" required placeholder="000.000.000-00" maxlength="14">
                </div>

                <!-- Data de nascimento -->
                <div class="form-group">
                    <label for="dataNascimento">Data de Nascimento *</label>
                    <input type="date" id="dataNascimento" required>
                </div>

                <!-- Telefone -->
                <div class="form-group">
                    <label for="telefone">Telefone *</label>
                    <input type="tel" id="telefone" required placeholder="(00) 00000-0000">
                </div>

                <!-- E-mail -->
                <div class="form-group">
                    <label for="email">E-mail *</label>
                    <input type="email" id="email" required placeholder="exemplo@email.com">
                </div>

                <!-- Tipo de plano (Normal ou VIP) -->
                <div class="form-group">
                    <label for="tipo">Tipo de Plano *</label>
                    <select id="tipo" required>
                        <option value="">Selecione...</option>
                        <option value="Normal">Normal</option>
                        <option value="VIP">VIP</option>
                    </select>
                </div>

                <!-- Data de inÃ­cio no plano -->
                <div class="form-group">
                    <label for="dataInicio">Data de InÃ­cio *</label>
                    <input type="date" id="dataInicio" required>
                </div>

                <!-- ObservaÃ§Ãµes adicionais -->
                <div class="form-group">
                    <label for="observacoes">ObservaÃ§Ãµes</label>
                    <textarea id="observacoes" placeholder="InformaÃ§Ãµes adicionais sobre o cliente..."></textarea>
                </div>

                <!-- BotÃµes de aÃ§Ã£o -->
                <button type="submit" class="btn-primary">ğŸ’¾ Salvar Cliente</button>
                <button type="button" class="btn-secondary" onclick="limparFormulario()">ğŸ”„ Limpar</button>
            </form>
        </div>

        <!-- MENSAGEM DE FEEDBACK -->
        <div id="mensagem" style="display: none;"></div>

        <!-- TABELA DE CLIENTES -->
        <div class="table-box">
            <h2>ğŸ“‹ Lista de Clientes</h2>
            
            <!-- Campo de busca -->
            <div style="margin-bottom: 15px;">
                <input type="text" id="buscarCliente" placeholder="ğŸ” Buscar cliente..." 
                       style="padding: 10px; width: 100%; max-width: 400px; border: 2px solid #e0e0e0; border-radius: 8px;">
            </div>
            
            <!-- Tabela -->
            <table id="tabelaClientes">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>CPF</th>
                        <th>Telefone</th>
                        <th>E-mail</th>
                        <th>Tipo</th>
                        <th>Data InÃ­cio</th>
                        <th>AÃ§Ãµes</th>
                    </tr>
                </thead>
                <tbody id="listaClientes">
                    <tr>
                        <td colspan="7" style="text-align: center; color: #999;">
                            Nenhum cliente cadastrado ainda
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <!-- RODAPÃ‰ -->
    <footer>
        <div class="container">
            <p>&copy; 2024 Vida SaudÃ¡vel - Todos os direitos reservados</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="../script.js"></script>
    <script>
        // Quando a pÃ¡gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            carregarClientes(); // Carrega lista de clientes
            
            // Define data de hoje automaticamente
            document.getElementById('dataInicio').valueAsDate = new Date();
        });

        // Salva novo cliente
        document.getElementById('formCliente').addEventListener('submit', function(e) {
            e.preventDefault(); // Evita recarregar pÃ¡gina
            
            // Cria objeto com dados do cliente
            const cliente = {
                id: Date.now(), // ID Ãºnico baseado no timestamp
                nome: document.getElementById('nome').value,
                cpf: document.getElementById('cpf').value,
                dataNascimento: document.getElementById('dataNascimento').value,
                telefone: document.getElementById('telefone').value,
                email: document.getElementById('email').value,
                tipo: document.getElementById('tipo').value,
                dataInicio: document.getElementById('dataInicio').value,
                observacoes: document.getElementById('observacoes').value,
                dataCadastro: new Date().toISOString()
            };
            
            // Busca clientes jÃ¡ cadastrados
            let clientes = JSON.parse(localStorage.getItem('clientes')) || [];
            
            // Adiciona o novo cliente
            clientes.push(cliente);
            
            // Salva no localStorage
            localStorage.setItem('clientes', JSON.stringify(clientes));
            
            // Mostra mensagem de sucesso
            mostrarMensagem('Cliente cadastrado com sucesso! âœ…', 'success');
            
            // Limpa o formulÃ¡rio
            limparFormulario();
            
            // Atualiza a lista
            carregarClientes();
        });

        // Carrega e exibe clientes na tabela
        function carregarClientes() {
            const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
            const tbody = document.getElementById('listaClientes');
            
            // Se nÃ£o houver clientes
            if (clientes.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #999;">Nenhum cliente cadastrado ainda</td></tr>';
                return;
            }
            
            tbody.innerHTML = '';
            
            // Cria linha para cada cliente
            clientes.forEach(cliente => {
                const tr = document.createElement('tr');
                
                // Define cor do badge (VIP Ã© dourado)
                const badgeClass = cliente.tipo === 'VIP' ? 'badge-vip' : 'badge-normal';
                
                tr.innerHTML = `
                    <td>${cliente.nome}</td>
                    <td>${cliente.cpf}</td>
                    <td>${cliente.telefone}</td>
                    <td>${cliente.email}</td>
                    <td><span class="badge ${badgeClass}">${cliente.tipo}</span></td>
                    <td>${formatarData(cliente.dataInicio)}</td>
                    <td>
                        <button class="btn-primary" style="padding: 5px 10px; font-size: 0.9em; margin-right: 5px;" 
                                onclick="verDetalhes(${cliente.id})">ğŸ‘ï¸ Ver</button>
                        <button class="btn-danger" style="padding: 5px 10px; font-size: 0.9em;" 
                                onclick="excluirCliente(${cliente.id})">ğŸ—‘ï¸ Excluir</button>
                    </td>
                `;
                
                tbody.appendChild(tr);
            });
        }

        // Busca em tempo real
        document.getElementById('buscarCliente').addEventListener('input', function(e) {
            const termo = e.target.value.toLowerCase();
            const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
            
            // Filtra clientes que correspondem ao termo
            const clientesFiltrados = clientes.filter(c => 
                c.nome.toLowerCase().includes(termo) ||
                c.cpf.includes(termo) ||
                c.email.toLowerCase().includes(termo)
            );
            
            const tbody = document.getElementById('listaClientes');
            tbody.innerHTML = '';
            
            // Se nÃ£o encontrar nada
            if (clientesFiltrados.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #999;">Nenhum cliente encontrado</td></tr>';
                return;
            }
            
            // Exibe resultados da busca
            clientesFiltrados.forEach(cliente => {
                const tr = document.createElement('tr');
                const badgeClass = cliente.tipo === 'VIP' ? 'badge-vip' : 'badge-normal';
                
                tr.innerHTML = `
                    <td>${cliente.nome}</td>
                    <td>${cliente.cpf}</td>
                    <td>${cliente.telefone}</td>
                    <td>${cliente.email}</td>
                    <td><span class="badge ${badgeClass}">${cliente.tipo}</span></td>
                    <td>${formatarData(cliente.dataInicio)}</td>
                    <td>
                        <button class="btn-primary" style="padding: 5px 10px; font-size: 0.9em; margin-right: 5px;" 
                                onclick="verDetalhes(${cliente.id})">ğŸ‘ï¸ Ver</button>
                        <button class="btn-danger" style="padding: 5px 10px; font-size: 0.9em;" 
                                onclick="excluirCliente(${cliente.id})">ğŸ—‘ï¸ Excluir</button>
                    </td>
                `;
                
                tbody.appendChild(tr);
            });
        });

        // Exclui cliente
        function excluirCliente(id) {
            if (confirm('Tem certeza que deseja excluir este cliente?')) {
                let clientes = JSON.parse(localStorage.getItem('clientes')) || [];
                clientes = clientes.filter(c => c.id !== id);
                localStorage.setItem('clientes', JSON.stringify(clientes));
                mostrarMensagem('Cliente excluÃ­do com sucesso!', 'success');
                carregarClientes();
            }
        }

        // Mostra detalhes completos do cliente
        function verDetalhes(id) {
            const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
            const cliente = clientes.find(c => c.id === id);
            
            if (cliente) {
                alert(`
ğŸ“‹ DETALHES DO CLIENTE

Nome: ${cliente.nome}
CPF: ${cliente.cpf}
Data Nascimento: ${formatarData(cliente.dataNascimento)}
Telefone: ${cliente.telefone}
E-mail: ${cliente.email}
Tipo: ${cliente.tipo}
Data InÃ­cio: ${formatarData(cliente.dataInicio)}
ObservaÃ§Ãµes: ${cliente.observacoes || 'Nenhuma'}
                `);
            }
        }

        // Limpa todos os campos do formulÃ¡rio
        function limparFormulario() {
            document.getElementById('formCliente').reset();
            document.getElementById('dataInicio').valueAsDate = new Date();
        }

        // Exibe mensagem temporÃ¡ria de sucesso/erro
        function mostrarMensagem(texto, tipo) {
            const div = document.getElementById('mensagem');
            div.className = tipo === 'success' ? 'alert alert-success' : 'alert alert-danger';
            div.textContent = texto;
            div.style.display = 'block';
            
            // Esconde apÃ³s 3 segundos
            setTimeout(() => {
                div.style.display = 'none';
            }, 3000);
        }

        // Converte data para formato brasileiro
        function formatarData(data) {
            const d = new Date(data + 'T00:00:00');
            return d.toLocaleDateString('pt-BR');
        }
    </script>
</body>
</html>